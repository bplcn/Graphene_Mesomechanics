'''
MatrixAngelAverage_4order_sqrt2(AMatrix)
Average a 3*3*3*3 tensor over a spherical surface, and return the average tensor AMatrixAverage of AMatrix.
'''
function MatrixAngelAverage_4order_sqrt2(AMatrix)

 #=
 The quadrature process of the matrix over 360 degree
    syms theta phai
#     QMatrix = [sin(theta)*cos(phai),-cos(theta)*cos(phai),sin(phai);...
#                sin(theta)*sin(phai),-cos(theta)*sin(phai),-cos(phai);...
#                cos(theta),sin(theta),0];
    QMatrix = [cos(theta),sin(theta)*cos(phai),sin(phai)*sin(theta);...
               -sin(theta),cos(theta)*cos(phai),cos(theta)*sin(phai);...
               0,-sin(phai),cos(phai)];
    T1Matrix = [QMatrix(1,1)^2,QMatrix(2,1)^2,QMatrix(3,1)^2;...
                QMatrix(1,2)^2,QMatrix(2,2)^2,QMatrix(3,2)^2;...
                QMatrix(1,3)^2,QMatrix(2,3)^2,QMatrix(3,3)^2];
    T2Matrix = [QMatrix(2,1)*QMatrix(3,1),QMatrix(3,1)*QMatrix(1,1),QMatrix(1,1)*QMatrix(2,1);...
                QMatrix(2,2)*QMatrix(3,2),QMatrix(3,2)*QMatrix(1,2),QMatrix(1,2)*QMatrix(2,2);...
                QMatrix(2,3)*QMatrix(3,3),QMatrix(3,3)*QMatrix(1,3),QMatrix(1,3)*QMatrix(2,3)];
    T3Matrix = [QMatrix(1,2)*QMatrix(1,3),QMatrix(2,2)*QMatrix(2,3),QMatrix(3,2)*QMatrix(3,3);...
                QMatrix(1,3)*QMatrix(1,1),QMatrix(2,3)*QMatrix(2,1),QMatrix(3,3)*QMatrix(3,1);...
                QMatrix(1,2)*QMatrix(1,1),QMatrix(2,1)*QMatrix(2,2),QMatrix(3,1)*QMatrix(3,2)];
    T4Matrix = [QMatrix(2,2)*QMatrix(3,3)+QMatrix(2,3)*QMatrix(3,2),QMatrix(3,2)*QMatrix(1,3)+QMatrix(3,3)*QMatrix(1,2),QMatrix(1,2)*QMatrix(2,3)+QMatrix(1,3)*QMatrix(2,2);...
                QMatrix(2,3)*QMatrix(3,1)+QMatrix(2,1)*QMatrix(3,3),QMatrix(3,3)*QMatrix(1,1)+QMatrix(3,1)*QMatrix(1,3),QMatrix(1,3)*QMatrix(2,1)+QMatrix(1,1)*QMatrix(2,3);...
                QMatrix(2,1)*QMatrix(3,2)+QMatrix(2,2)*QMatrix(3,1),QMatrix(3,1)*QMatrix(1,2)+QMatrix(3,2)*QMatrix(1,1),QMatrix(1,1)*QMatrix(2,2)+QMatrix(1,2)*QMatrix(2,1)];
    TMatrix = [T1Matrix,sqrt(2)*T2Matrix;sqrt(2)*T3Matrix,T4Matrix];
#   TransInvTMatrix = [T1Matrix,T2Matrix;2*T3Matrix,T4Matrix];
    InvTMatrix = transpose(TMatrix);

    ATensorAverage = int(int(TMatrix*AMatrix*InvTMatrix*sin(theta),phai,[0,2*pi]),theta,[0,pi]);
    AMatrixAverage = ATensorAverage/4/pi;

 =#

    A11 = AMatrix[1,1)/5 + (2*AMatrix(1,2))/15 + (2*AMatrix(2,1))/15 + ...
        (8*AMatrix(2,2))/15 + (4*AMatrix(6,6))/15;
    A12 = AMatrix(1,1)/15 + AMatrix(1,2)/10 + AMatrix(1,3)/6 + ...
        (4*AMatrix(2,1))/15 + AMatrix(2,2)/15 + AMatrix(2,3)/3 - (2*AMatrix(6,6))/15;
    A13 = AMatrix(1,1)/15 + AMatrix(1,2)/10 + AMatrix(1,3)/6 + ...
        (4*AMatrix(2,1))/15 + AMatrix(2,2)/15 + AMatrix(2,3)/3 - (2*AMatrix(6,6))/15;
    A14 = 0;
    A15 = 0;
    A16 = 0;

    A21 = AMatrix(1,1)/15 + (4*AMatrix(1,2))/15 + AMatrix(2,1)/10 + AMatrix(2,2)/15 +...
        AMatrix(3,1)/6 + AMatrix(3,2)/3 - (2*AMatrix(6,6))/15;
    A22 = AMatrix(1,1)/5 + AMatrix(1,2)/20 + AMatrix(1,3)/12 + AMatrix(2,1)/20 + ...
        (3*AMatrix(2,2))/40 + AMatrix(2,3)/24 + AMatrix(3,1)/12 + AMatrix(3,2)/24 + ...
        (3*AMatrix(3,3))/8 + AMatrix(4,4)/12 + AMatrix(5,5)/6 + AMatrix(6,6)/10;
    A23 = AMatrix(1,1)/15 + AMatrix(1,2)/60 + AMatrix(1,3)/4 + AMatrix(2,1)/60 +...
        AMatrix(2,2)/40 + AMatrix(2,3)/8 + AMatrix(3,1)/4 + AMatrix(3,2)/8 + ...
        AMatrix(3,3)/8 - AMatrix(4,4)/12 - AMatrix(5,5)/6 + AMatrix(6,6)/30;
    A24 = (pi*(3*AMatrix(1,5) + AMatrix(2,5) - 4*AMatrix(3,5) - ...
        3*AMatrix(5,1) - AMatrix(5,2) + 4*AMatrix(5,3) - 2^(1/2)*AMatrix(4,6) ...
        + 2^(1/2)*AMatrix(6,4)))/64;
    A25 = 0;
    A26 = 0;

    A31 = AMatrix(1,1)/15 + (4*AMatrix(1,2))/15 + AMatrix(2,1)/10 + ...
        AMatrix(2,2)/15 + AMatrix(3,1)/6 + AMatrix(3,2)/3 - (2*AMatrix(6,6))/15;
    A32 = AMatrix(1,1)/15 + AMatrix(1,2)/60 + AMatrix(1,3)/4 + ...
        AMatrix(2,1)/60 + AMatrix(2,2)/40 + AMatrix(2,3)/8 + AMatrix(3,1)/4 + ...
        AMatrix(3,2)/8 + AMatrix(3,3)/8 - AMatrix(4,4)/12 - AMatrix(5,5)/6 + ...
        AMatrix(6,6)/30;
    A33 = AMatrix(1,1)/5 + AMatrix(1,2)/20 + AMatrix(1,3)/12 + AMatrix(2,1)/20 + ...
        (3*AMatrix(2,2))/40 + AMatrix(2,3)/24 + AMatrix(3,1)/12 + ...
        AMatrix(3,2)/24 + (3*AMatrix(3,3))/8 + AMatrix(4,4)/12 + ...
        AMatrix(5,5)/6 + AMatrix(6,6)/10;
    A34 = -(pi*(3*AMatrix(1,5) + AMatrix(2,5) - 4*AMatrix(3,5) - ...
        3*AMatrix(5,1) - AMatrix(5,2) + 4*AMatrix(5,3) - ...
        2^(1/2)*AMatrix(4,6) + 2^(1/2)*AMatrix(6,4)))/64;
    A35 = 0;
    A36 = 0;

    A41 = 0;
    A42 = -(pi*(3*AMatrix(1,5) + AMatrix(2,5) - 4*AMatrix(3,5) - ...
        3*AMatrix(5,1) - AMatrix(5,2) + 4*AMatrix(5,3) - 2^(1/2)*AMatrix(4,6) + ...
        2^(1/2)*AMatrix(6,4)))/64;
    A43 = (pi*(3*AMatrix(1,5) + AMatrix(2,5) - 4*AMatrix(3,5) - 3*AMatrix(5,1) - ...
        AMatrix(5,2) + 4*AMatrix(5,3) - 2^(1/2)*AMatrix(4,6) + ...
        2^(1/2)*AMatrix(6,4)))/64;
    A44 = (2*AMatrix(1,1))/15 + AMatrix(1,2)/30 - AMatrix(1,3)/6 + AMatrix(2,1)/30 + ...
        AMatrix(2,2)/20 - AMatrix(2,3)/12 - AMatrix(3,1)/6 - AMatrix(3,2)/12 + ...
        AMatrix(3,3)/4 + AMatrix(4,4)/6 + AMatrix(5,5)/3 + AMatrix(6,6)/15;
    A45 = 0;
    A46 = 0;

    A51 = 0;
    A52 = 0;
    A53 = 0;
    A54 = 0;
    A55 = (2*AMatrix(1,1))/15 - (2*AMatrix(1,2))/15 - (2*AMatrix(2,1))/15 + ...
        (2*AMatrix(2,2))/15 + AMatrix(4,4)/3 + AMatrix(5,5)/6 + (7*AMatrix(6,6))/30;
    A56 = (pi*(2*AMatrix(4,6) - 2*AMatrix(6,4) - 2^(1/2)*AMatrix(1,5) + ...
        2^(1/2)*AMatrix(2,5) + 2^(1/2)*AMatrix(5,1) - 2^(1/2)*AMatrix(5,2)))/32;

    A61 = 0;
    A62 = 0;
    A63 = 0;
    A64 = 0;
    A65 = -(pi*(2*AMatrix(4,6) - 2*AMatrix(6,4) - 2^(1/2)*AMatrix(1,5) + ...
        2^(1/2)*AMatrix(2,5) + 2^(1/2)*AMatrix(5,1) - 2^(1/2)*AMatrix(5,2)))/32;
    A66 = (2*AMatrix(1,1))/15 - (2*AMatrix(1,2))/15 - (2*AMatrix(2,1))/15 + ...
        (2*AMatrix(2,2))/15 + AMatrix(4,4)/3 + AMatrix(5,5)/6 + (7*AMatrix(6,6))/30;

    AMatrixAverage = [A11,A12,A13,A14,A15,A16;A21,A22,A23,A24,A25,A26;...
                  A31,A32,A33,A34,A35,A36;A41,A42,A43,A44,A45,A46;...
                  A51,A52,A53,A54,A55,A56;A61,A62,A63,A64,A65,A66];

    return AMatrixAverage
end
